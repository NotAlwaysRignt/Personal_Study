# 重试
顾名思义即失败时重新发起请求

重试的拓展，重试里有很多策略

### 对冲
对冲是与重试并列的策略,对冲的概念是
在延时时间内没有收到回包，则不等回包就再发送一次请求，对冲策略一般对于解决长尾请求对高扇出服务的影响

### 负载均衡
重试时,可能要求重试的节点与失败的节点IP不同,这里就要记录上次请求的IP

### 限流
重试和对冲都会造成雪崩，所以要采取限流策略
一种限流算法：每个service都维护一个令牌(token)桶, 每成功N次可以使得桶的令牌值加1,失败一次则使令牌桶减M
比如成功10次,我们就多了一次重试的机会,失败一次,就会减少一次重试的机会

这样如果底层服务异常,不可服务了,我们的令牌数就会很少,也不会对其进行大量的重试,避免了雪崩的发生

### 重试错误码
哪些错误码是业务错误码,不需要重试的,哪些错误码是需要重试的,比如通常的网络超时,这里要有区分